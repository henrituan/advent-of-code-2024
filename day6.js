const parseInput = (input) => {
  return input.split("\n").map((row) => row.split(""));
};

const count1 = (input) => {
  const map = parseInput(input);

  const maxX = map[0].length - 1;
  const maxY = map.length - 1;

  console.log({ maxX, maxY });
  let rslt = 1;

  while (true) {
    const currentY = map.findIndex(
      (row) =>
        row.includes("^") ||
        row.includes("v") ||
        row.includes("<") ||
        row.includes(">")
    );

    const currentRow = map[currentY];
    const currentX = currentRow.findIndex(
      (cell) => cell === "^" || cell === "v" || cell === "<" || cell === ">"
    );

    const currentCell = currentRow[currentX];

    // console.log({
    //   currentY,
    //   currentX,
    //   currentCell,
    // });

    // check outerbounds
    if (currentCell === "^" && currentY === 0) break;
    if (currentCell === "v" && currentY === maxY) break;
    if (currentCell === "<" && currentX === 0) break;
    if (currentCell === ">" && currentX === maxX) break;

    // check next cell
    if (currentCell === "^") {
      const aboveCell = map[currentY - 1][currentX];
      if (aboveCell === "#") {
        if (currentX === maxX) {
          break;
        }
        const rightCell = map[currentY][currentX + 1];
        if (rightCell === ".") {
          rslt++;
        }
        map[currentY][currentX + 1] = ">";
      } else {
        // map[currentY - 1][currentX] = "^";
        const aboveCell = map[currentY - 1][currentX];
        if (aboveCell === ".") {
          rslt++;
        }
        map[currentY - 1][currentX] = "^";
      }
      map[currentY][currentX] = "X";
    }

    if (currentCell === "v") {
      const belowCell = map[currentY + 1][currentX];
      if (belowCell === "#") {
        if (currentX === 0) {
          break;
        }
        // map[currentY][currentX - 1] = "<";
        const leftCell = map[currentY][currentX - 1];
        if (leftCell === ".") {
          rslt++;
        }
        map[currentY][currentX - 1] = "<";
      } else {
        // map[currentY + 1][currentX] = "v";
        const belowCell = map[currentY + 1][currentX];
        if (belowCell === ".") {
          rslt++;
        }
        map[currentY + 1][currentX] = "v";
      }
      map[currentY][currentX] = "X";
    }

    if (currentCell === "<") {
      const leftCell = map[currentY][currentX - 1];
      if (leftCell === "#") {
        if (currentY === 0) {
          break;
        }
        // map[currentY - 1][currentX] = "^";
        const aboveCell = map[currentY - 1][currentX];
        if (aboveCell === ".") {
          rslt++;
        }
        map[currentY - 1][currentX] = "^";
      } else {
        // map[currentY][currentX - 1] = "<";
        const leftCell = map[currentY][currentX - 1];
        if (leftCell === ".") {
          rslt++;
        }
        map[currentY][currentX - 1] = "<";
      }
      map[currentY][currentX] = "X";
    }

    if (currentCell === ">") {
      const rightCell = map[currentY][currentX + 1];
      if (rightCell === "#") {
        if (currentY === maxY) {
          break;
        }
        // map[currentY + 1][currentX] = "v";
        const belowCell = map[currentY + 1][currentX];
        if (belowCell === ".") {
          rslt++;
        }
        map[currentY + 1][currentX] = "v";
      } else {
        // map[currentY][currentX + 1] = ">";
        const rightCell = map[currentY][currentX + 1];
        if (rightCell === ".") {
          rslt++;
        }
        map[currentY][currentX + 1] = ">";
      }
      map[currentY][currentX] = "X";
    }
  }

  return rslt;
};

const input1 = `....#.....
.........#
..........
..#.......
.......#..
..........
.#..^.....
........#.
#.........
......#...`;

const input2 = `#.............#.#...........................................................#..........#...........................#..........#...
............#......................#.......#..#.........#...................##....................................................
..............#...........#..#.......#.........#.#...........................#................................#......#............
.....#......................................#......#..#...................#....................#......................#...........
...#............................#................................#................................................................
..........#..................#.....#......................................................#.......................................
..#........#.......#.#...............................................................#......#.................................#...
.#....#................#................#.....#...................#...............................................#..#............
.......................................................................................#...#.#....#........##......#........#.#.##
............................................#.................#.....................#..........................#..................
....#..........##......................#.................................................................................#........
......#.............##.........#.......#.........#.......#.............#...#.......#..............................................
.#............................................................................#..........#....#...................................
...#..#....#..............................#...........................................................................#...........
.............#....................................................................................................................
................................#..................##...................................#...............................#......#..
..........#.........#.................#..........###...........................................#............#...#.................
.............#....................................#.......#.#.#............#............................................#.........
......#.#..............................................................................................#.........................#
...#...#.........#.........#..#......#................##.................#........................................................
.................................#......................#........#................#........................#......................
.......................##..............#................#................#..............................#.........................
.......#...#.....#.....##........................#..................##.....#......................................................
.............................................#...........................#..........................................#.....#.......
.........................#...............#....#..............#.......#...............#.#.................#.................#......
...........................................................#....#..................................#..............................
..........................#.................................................#............................##....#..................
.................#...#.........................................................#........................#.....#..#................
.........................#....#................................................#...#.....................#....#...........#.......
................................................##.......#.#....................................#.......##........................
..........##...#.......................#....#..#....................#........................#....................................
#......#.......................#............#.....................................................................#...............
.......#.......#...#..#..........#.......................................#.............#......#...................................
...............#............#..................#.................................................................................#
.......#...........#.......................##.....#.........#...........#...................#......#.........#.............##....#
...................#.........................#......#..........................................#..........#.........#......#......
.....#............#..............#...#......#....................#.............#..................................................
................................................#........#.....#...................#.....................................#.....#..
......................#.#...##......................##...............................................#.................#..........
#...................#.........................#...........#.....#................#.....................#...................#......
....#................#.....#.............#.....................................#....#...#.................................#.......
.........#.....................................................................................................#.#.......#........
.........#..........##..............................#............................#.#.............................#................
#....#.#..............................................##...#...#...............#.............#....................................
........#..#.#...................#.......................................................................#.............#..#.#...#.
.................................................................................................................#.......#........
............................................#..#...............##........#..........#.......................................#....#
........#...........................#............................#.....#........................#..........#...#..........#.......
.#...........#...................................................#...........................................#................#.#.
............#...............................#........#...........#..........#...........#.#..............#........................
...............................................................................##.#................#..............................
.#.......................#.#...........#..................................#.......................................................
..#..............................................##................#.......#....#..............#.....................#...#........
...................#.....#................................................#..........#.........#.........#.....................#..
........#................#................................................................................#......#................
...................#...#....#.........................#.........................#....................#..........................#.
.................#.......................................................#................................................#.......
..#...........................##.#.............#..#............................................#.......................#.#........
..#......#.........................................................................#.......................#......................
...........................................................................................................#............#......#..
............................................................^..........................................#..........#...............
..#.........#....................#..........................................#........#.........................................#..
........#...............#....#.............#......#.........................................................................#.....
.........#......#.....#..............#...........................................................#..............#.................
.........#...................................................#...###...........#.......#.##.......................................
.....................##.................#.........##.....................#................#................#.........#............
.......................................................................#..............#..............#.................#..........
.##.........#..........................................................................#....................................#.....
.........................#.............................#........................................................................#.
........#.............................................#......#....#.....................................#....................#....
........#...#..............................................................................#.........#............................
..............................#................................#..........#..............#..................................#.....
........##..#...................................#................................#.................#.........#......#..#........#.
..................#......#...................................................................#....................................
..........#.............#..............#........#............#...............#..#..........#..............#.#...#............#....
............................##....#..............#......................................................................#.........
...............................................#.....#...........#.....##...............#..#......................................
.........................#.......#...............................#...........#.........#...........#....#.........................
.#............#...#...............#..............................................................#..........................#....#
#...........#......................................................#.............................#......#.........................
..................................................#....#...............#.........................#................................
................................................#..........................#.......#..............................#....##.......#.
........#......#..#............#................#............................#......#.##.........#....................#..#........
.......................................................#..#.#....................#..#......................................#......
.....................#.......................................................................#............#.......................
.....................##........................#...................#.....................#........................................
..........................#...........................................................................................#...........
..#..........#...................#..............##..#.....................#...................#..............#...........#........
#................................#....##......#.............#..............#.......................#.........#...........#........
..................#................#...............................#.....#..........#................#..............#.............
................#.#.........#.....##...............................................................#..............#...............
..#...............................................................................................#...............................
..........#.................#...........#.......#.........................#...#.......#...........................................
..##....#......................................#.#.......................................#.................#......................
.......................#..#...#.##......................................................................#.........#...#...........
...............#.........#..............#.....................................................#...................#...............
......#.................#............#......#...................#..#.........................#........................#........#..
......................................................................#...........................#........#......................
..........#..........#........................#.............##....................................................................
....#................................................#.......................#................#...............#...................
.................#....................................................#......#....................................................
.#........#.......................................................................................................................
......##..................#....#......#.................#....................#.....................#..#...........#...............
#...#...#...#..............#........#.......................#.#..........#...............................#......#.................
#...#...................#.............#........#..........#...............................................................#...#...
..#................................#...#.........................#...................#......#.....................................
...#...###..........#............#...............................................................#..........#.....................
............#..............#.......#.....#..........#.....#.........................................................#............#
..#......................#..#...#................................#......#.......#.....#..................#.........#..............
....##......#.......................................................#..............................................#..............
...............................#.....#....#.................................................#.......#............#................
..........#....#......................#........#..........................#......#................................................
......#.............................#...........#..................#...........................#................................#.
...........................##..........................................#.....#.#.....................#................#...........
..#..............#.........................................................#........................#.........#.................#.
#.....#.....#......................#....................#........................................#...........#...........#......#.
.......................................#..#................................#.........#.......#..#.....#..........................#
..........#..............##...............#..........................................................#......#......#......#....#..
.............#..............#..#......#........#..#......##.......................#...........#.......#...........................
......................#.......................................#.......#..#.....................................#.........#...##...
...........................#...........................#......#....#.............................#.............................#..
..................#............................#....#........##.........................#..............#.............#............
.......#....................#.....#........#.......#.#...#...............#.....#.#.........................#.......#.#............
.....#.........#.......#..........#.................#..#...#..................................................##..................
................#........................................................#........................................................
....##......#........#..................#.........................#...................................#...#...................#...
..............#....................#.......#.......................#.............#......#..............#..........................
...........................#..............#.....#............#.....................#........#....#.......................#........
........#..##................#.....#.#..............#..............................#........................#.........#...........
.........................................................#...........................##..........#........#.##....................`;

const rslt1 = count1(input2);
console.log(rslt1);
